#!/bin/bash

www="`echo $1 | awk -F . '{print $1}'`"
subzone="`echo $1 | awk -F . '{print $2}'`"

if [ $subzone != cat /etc/bind/zones/scriptzones/db.$subzone.tuan-temmerman.sb.uclllabs.be | grep -E '[0-9].[0-9].[0-9].[0-9]' | awk '{print $1}']; then
	exit 1
else

	if [ -e "/etc/bind/zones/scriptzones/db.$subzone" ]; then

		mkdir /var/www/$1
		touch /var/www/$1/index.html

		echo "welcome $1" > /var/www/$1/index.html

		touch /etc/apache2/sites-available/$1.conf

		echo "
		<VirtualHost *:80>
			ServerAdmin r0705046@student.ucll.be
		       	ServerName $1
		      	DocumentRoot /var/www/$1
		     	LogLevel info
		       	ErrorLog "${APACHE_LOG_DIR}"/$1-error.log
		       	CustomLog "${APACHE_LOG_DIR}"/$1-access.log combined
		</VirtualHost>" > /etc/apache2/sites-available/$1.conf

		a2ensite $1.conf
		systemctl restart apache2

		else
		   	exit 1
	fi
fi
